// git.status = clean, build.date = Wed Jul 16 15:10:02 EDT 2025, git.hash = 164c2dd
import "primitives/core.futil";
import "primitives/memories/seq.futil";
import "primitives/binary_operators.futil";
component main() -> () {
  cells {
    add0 = std_add(32);
    add1 = std_add(32);
    add10 = std_add(32);
    add11 = std_add(32);
    add12 = std_add(32);
    add13 = std_add(32);
    add14 = std_add(4);
    add15 = std_add(4);
    add16 = std_add(32);
    add17 = std_add(32);
    add2 = std_add(32);
    add3 = std_add(32);
    add4 = std_add(32);
    add5 = std_add(32);
    add6 = std_add(32);
    add7 = std_add(32);
    add8 = std_add(32);
    add9 = std_add(32);
    and0 = std_and(4);
    and1 = std_and(4);
    const0 = std_const(32,1);
    const1 = std_const(32,0);
    const10 = std_const(32,0);
    const11 = std_const(2,1);
    const12 = std_const(32,1);
    const13 = std_const(32,1);
    const14 = std_const(32,0);
    const15 = std_const(32,1);
    const16 = std_const(32,1);
    const17 = std_const(32,4);
    const18 = std_const(32,4);
    const19 = std_const(32,1);
    const2 = std_const(4,0);
    const20 = std_const(32,1);
    const21 = std_const(32,4);
    const22 = std_const(32,1);
    const23 = std_const(32,1);
    const24 = std_const(32,4);
    const25 = std_const(32,1);
    const26 = std_const(32,1);
    const27 = std_const(32,4);
    const28 = std_const(32,1);
    const29 = std_const(32,1);
    const3 = std_const(4,1);
    const30 = std_const(32,4);
    const31 = std_const(32,1);
    const32 = std_const(32,1);
    const33 = std_const(32,1);
    const34 = std_const(32,1);
    const35 = std_const(4,1);
    const36 = std_const(4,1);
    const37 = std_const(4,1);
    const38 = std_const(4,1);
    const39 = std_const(32,0);
    const4 = std_const(32,0);
    const40 = std_const(32,0);
    const41 = std_const(32,0);
    const42 = std_const(32,1);
    const43 = std_const(32,1);
    const5 = std_const(32,0);
    const6 = std_const(2,0);
    const7 = std_const(32,1);
    const8 = std_const(32,1);
    const9 = std_const(32,0);
    currSand_0 = std_reg(32);
    current_0 = std_reg(4);
    ge0 = std_ge(32);
    ge1 = std_ge(32);
    ge2 = std_ge(32);
    ge3 = std_ge(32);
    ge4 = std_ge(32);
    i0 = std_reg(32);
    i1 = std_reg(32);
    i2 = std_reg(32);
    @external(1) in_int = seq_mem_d2(32,10,10,4,4);
    iterations_0 = std_reg(32);
    j0 = std_reg(32);
    j1 = std_reg(32);
    j2 = std_reg(32);
    neq0 = std_neq(32);
    newSand_0 = std_reg(32);
    next_0 = std_reg(4);
    @external(1) out_int = seq_mem_d2(32,10,10,4,4);
    slice0 = std_slice(32,4);
    slice1 = std_slice(32,4);
    slice10 = std_slice(32,4);
    slice11 = std_slice(4,2);
    slice12 = std_slice(32,4);
    slice13 = std_slice(32,4);
    slice14 = std_slice(4,2);
    slice15 = std_slice(32,4);
    slice16 = std_slice(32,4);
    slice17 = std_slice(4,2);
    slice18 = std_slice(32,4);
    slice19 = std_slice(32,4);
    slice2 = std_slice(32,4);
    slice20 = std_slice(4,2);
    slice21 = std_slice(32,4);
    slice22 = std_slice(32,4);
    slice23 = std_slice(4,2);
    slice24 = std_slice(32,4);
    slice25 = std_slice(32,4);
    slice26 = std_slice(4,2);
    slice27 = std_slice(32,4);
    slice28 = std_slice(32,4);
    slice29 = std_slice(32,4);
    slice3 = std_slice(32,4);
    slice30 = std_slice(32,4);
    slice4 = std_slice(32,4);
    slice5 = std_slice(32,4);
    slice6 = std_slice(32,4);
    slice7 = std_slice(32,4);
    slice8 = std_slice(4,2);
    slice9 = std_slice(32,4);
    spills_0 = std_reg(32);
    state0_0_0 = seq_mem_d3(32,2,10,10,2,4,4);
    state_read0_0 = std_reg(32);
    state_read1_0 = std_reg(32);
    state_read2_0 = std_reg(32);
    state_read3_0 = std_reg(32);
    state_read4_0 = std_reg(32);
    sub0 = std_sub(32);
    sub1 = std_sub(32);
    sub2 = std_sub(32);
    val_0 = std_reg(32);
    val_1 = std_reg(32);
    x0 = std_reg(32);
    y0 = std_reg(32);
  }
  wires {
    comb group cond0 {
      ge0.left = currSand_0.out;
      ge0.right = const17.out;
    }
    comb group cond1 {
      ge1.left = state_read0_0.out;
      ge1.right = const21.out;
    }
    comb group cond2 {
      ge2.left = state_read1_0.out;
      ge2.right = const24.out;
    }
    comb group cond3 {
      ge3.left = state_read2_0.out;
      ge3.right = const27.out;
    }
    comb group cond4 {
      ge4.left = state_read3_0.out;
      ge4.right = const30.out;
    }
    comb group cond5 {
      neq0.left = spills_0.out;
      neq0.right = const39.out;
    }
    group let0<"promotable"=1> {
      spills_0.in = const0.out;
      spills_0.write_en = 1'd1;
      let0[done] = spills_0.done;
    }
    group let1<"promotable"=1> {
      iterations_0.in = const1.out;
      iterations_0.write_en = 1'd1;
      let1[done] = iterations_0.done;
    }
    group let10<"promotable"=1> {
      y0.in = const15.out;
      y0.write_en = 1'd1;
      let10[done] = y0.done;
    }
    group let11<"promotable"=1> {
      x0.in = const16.out;
      x0.write_en = 1'd1;
      let11[done] = x0.done;
    }
    group let12<"promotable"=1> {
      i2.in = const40.out;
      i2.write_en = 1'd1;
      let12[done] = i2.done;
    }
    group let13<"promotable"=1> {
      j2.in = const41.out;
      j2.write_en = 1'd1;
      let13[done] = j2.done;
    }
    group let2<"promotable"=1> {
      current_0.in = const2.out;
      current_0.write_en = 1'd1;
      let2[done] = current_0.done;
    }
    group let3<"promotable"=1> {
      next_0.in = const3.out;
      next_0.write_en = 1'd1;
      let3[done] = next_0.done;
    }
    group let4<"promotable"=1> {
      i0.in = const4.out;
      i0.write_en = 1'd1;
      let4[done] = i0.done;
    }
    group let5<"promotable"=1> {
      j0.in = const5.out;
      j0.write_en = 1'd1;
      let5[done] = j0.done;
    }
    group let6<"promotable"=2> {
      val_0.in = in_int.read_data;
      val_0.write_en = in_int.done;
      let6[done] = val_0.done;
      in_int.content_en = 1'd1;
      in_int.addr1 = slice1.out;
      slice1.in = j0.out;
      in_int.addr0 = slice0.out;
      slice0.in = i0.out;
    }
    group let7<"promotable"=1> {
      i1.in = const9.out;
      i1.write_en = 1'd1;
      let7[done] = i1.done;
    }
    group let8<"promotable"=1> {
      j1.in = const10.out;
      j1.write_en = 1'd1;
      let8[done] = j1.done;
    }
    group let9<"promotable"=2> {
      val_1.in = in_int.read_data;
      val_1.write_en = in_int.done;
      let9[done] = val_1.done;
      in_int.content_en = 1'd1;
      in_int.addr1 = slice5.out;
      slice5.in = j1.out;
      in_int.addr0 = slice4.out;
      slice4.in = i1.out;
    }
    group upd0<"promotable"=1> {
      state0_0_0.content_en = 1'd1;
      state0_0_0.addr2 = slice3.out;
      slice3.in = j0.out;
      state0_0_0.addr1 = slice2.out;
      slice2.in = i0.out;
      state0_0_0.addr0 = const6.out;
      state0_0_0.write_en = 1'd1;
      state0_0_0.write_data = val_0.out;
      upd0[done] = state0_0_0.done;
    }
    group upd1<"promotable"=1> {
      j0.write_en = 1'd1;
      add0.left = j0.out;
      add0.right = const7.out;
      j0.in = add0.out;
      upd1[done] = j0.done;
    }
    group upd10<"promotable"=1> {
      newSand_0.write_en = 1'd1;
      newSand_0.in = currSand_0.out;
      upd10[done] = newSand_0.done;
    }
    group upd11<"promotable"=2> {
      state_read0_0.write_en = state0_0_0.done;
      state0_0_0.content_en = 1'd1;
      state0_0_0.addr2 = slice13.out;
      slice13.in = x0.out;
      state0_0_0.addr1 = slice12.out;
      slice12.in = sub1.out;
      sub1.left = y0.out;
      sub1.right = const20.out;
      state0_0_0.addr0 = slice11.out;
      slice11.in = current_0.out;
      state_read0_0.in = state0_0_0.read_data;
      upd11[done] = state_read0_0.done;
    }
    group upd12<"promotable"=1> {
      newSand_0.write_en = 1'd1;
      add5.left = newSand_0.out;
      add5.right = const22.out;
      newSand_0.in = add5.out;
      upd12[done] = newSand_0.done;
    }
    group upd13<"promotable"=2> {
      state_read1_0.write_en = state0_0_0.done;
      state0_0_0.content_en = 1'd1;
      state0_0_0.addr2 = slice16.out;
      slice16.in = x0.out;
      state0_0_0.addr1 = slice15.out;
      slice15.in = add6.out;
      add6.left = y0.out;
      add6.right = const23.out;
      state0_0_0.addr0 = slice14.out;
      slice14.in = current_0.out;
      state_read1_0.in = state0_0_0.read_data;
      upd13[done] = state_read1_0.done;
    }
    group upd14<"promotable"=1> {
      newSand_0.write_en = 1'd1;
      add7.left = newSand_0.out;
      add7.right = const25.out;
      newSand_0.in = add7.out;
      upd14[done] = newSand_0.done;
    }
    group upd15<"promotable"=2> {
      state_read2_0.write_en = state0_0_0.done;
      state0_0_0.content_en = 1'd1;
      state0_0_0.addr2 = slice19.out;
      slice19.in = add8.out;
      add8.left = x0.out;
      add8.right = const26.out;
      state0_0_0.addr1 = slice18.out;
      slice18.in = y0.out;
      state0_0_0.addr0 = slice17.out;
      slice17.in = current_0.out;
      state_read2_0.in = state0_0_0.read_data;
      upd15[done] = state_read2_0.done;
    }
    group upd16<"promotable"=1> {
      newSand_0.write_en = 1'd1;
      add9.left = newSand_0.out;
      add9.right = const28.out;
      newSand_0.in = add9.out;
      upd16[done] = newSand_0.done;
    }
    group upd17<"promotable"=2> {
      state_read3_0.write_en = state0_0_0.done;
      state0_0_0.content_en = 1'd1;
      state0_0_0.addr2 = slice22.out;
      slice22.in = sub2.out;
      sub2.left = x0.out;
      sub2.right = const29.out;
      state0_0_0.addr1 = slice21.out;
      slice21.in = y0.out;
      state0_0_0.addr0 = slice20.out;
      slice20.in = current_0.out;
      state_read3_0.in = state0_0_0.read_data;
      upd17[done] = state_read3_0.done;
    }
    group upd18<"promotable"=1> {
      newSand_0.write_en = 1'd1;
      add10.left = newSand_0.out;
      add10.right = const31.out;
      newSand_0.in = add10.out;
      upd18[done] = newSand_0.done;
    }
    group upd19<"promotable"=1> {
      state0_0_0.content_en = 1'd1;
      state0_0_0.addr2 = slice25.out;
      slice25.in = x0.out;
      state0_0_0.addr1 = slice24.out;
      slice24.in = y0.out;
      state0_0_0.addr0 = slice23.out;
      slice23.in = next_0.out;
      state0_0_0.write_en = 1'd1;
      state0_0_0.write_data = newSand_0.out;
      upd19[done] = state0_0_0.done;
    }
    group upd2<"promotable"=1> {
      i0.write_en = 1'd1;
      add1.left = i0.out;
      add1.right = const8.out;
      i0.in = add1.out;
      upd2[done] = i0.done;
    }
    group upd20<"promotable"=1> {
      x0.write_en = 1'd1;
      add11.left = x0.out;
      add11.right = const32.out;
      x0.in = add11.out;
      upd20[done] = x0.done;
    }
    group upd21<"promotable"=1> {
      y0.write_en = 1'd1;
      add12.left = y0.out;
      add12.right = const33.out;
      y0.in = add12.out;
      upd21[done] = y0.done;
    }
    group upd22<"promotable"=1> {
      iterations_0.write_en = 1'd1;
      add13.left = iterations_0.out;
      add13.right = const34.out;
      iterations_0.in = add13.out;
      upd22[done] = iterations_0.done;
    }
    group upd23<"promotable"=1> {
      current_0.write_en = 1'd1;
      and0.left = add14.out;
      and0.right = const36.out;
      add14.left = current_0.out;
      add14.right = const35.out;
      current_0.in = and0.out;
      upd23[done] = current_0.done;
    }
    group upd24<"promotable"=1> {
      next_0.write_en = 1'd1;
      and1.left = add15.out;
      and1.right = const38.out;
      add15.left = next_0.out;
      add15.right = const37.out;
      next_0.in = and1.out;
      upd24[done] = next_0.done;
    }
    group upd25<"promotable"=2> {
      state_read4_0.write_en = state0_0_0.done;
      state0_0_0.content_en = 1'd1;
      state0_0_0.addr2 = slice28.out;
      slice28.in = j2.out;
      state0_0_0.addr1 = slice27.out;
      slice27.in = i2.out;
      state0_0_0.addr0 = slice26.out;
      slice26.in = current_0.out;
      state_read4_0.in = state0_0_0.read_data;
      upd25[done] = state_read4_0.done;
    }
    group upd26<"promotable"=1> {
      out_int.content_en = 1'd1;
      out_int.addr1 = slice30.out;
      slice30.in = j2.out;
      out_int.addr0 = slice29.out;
      slice29.in = i2.out;
      out_int.write_en = 1'd1;
      out_int.write_data = state_read4_0.out;
      upd26[done] = out_int.done;
    }
    group upd27<"promotable"=1> {
      j2.write_en = 1'd1;
      add16.left = j2.out;
      add16.right = const42.out;
      j2.in = add16.out;
      upd27[done] = j2.done;
    }
    group upd28<"promotable"=1> {
      i2.write_en = 1'd1;
      add17.left = i2.out;
      add17.right = const43.out;
      i2.in = add17.out;
      upd28[done] = i2.done;
    }
    group upd3<"promotable"=1> {
      state0_0_0.content_en = 1'd1;
      state0_0_0.addr2 = slice7.out;
      slice7.in = j1.out;
      state0_0_0.addr1 = slice6.out;
      slice6.in = i1.out;
      state0_0_0.addr0 = const11.out;
      state0_0_0.write_en = 1'd1;
      state0_0_0.write_data = val_1.out;
      upd3[done] = state0_0_0.done;
    }
    group upd4<"promotable"=1> {
      j1.write_en = 1'd1;
      add2.left = j1.out;
      add2.right = const12.out;
      j1.in = add2.out;
      upd4[done] = j1.done;
    }
    group upd5<"promotable"=1> {
      i1.write_en = 1'd1;
      add3.left = i1.out;
      add3.right = const13.out;
      i1.in = add3.out;
      upd5[done] = i1.done;
    }
    group upd6<"promotable"=1> {
      spills_0.write_en = 1'd1;
      spills_0.in = const14.out;
      upd6[done] = spills_0.done;
    }
    group upd7<"promotable"=2> {
      currSand_0.write_en = state0_0_0.done;
      state0_0_0.content_en = 1'd1;
      state0_0_0.addr2 = slice10.out;
      slice10.in = x0.out;
      state0_0_0.addr1 = slice9.out;
      slice9.in = y0.out;
      state0_0_0.addr0 = slice8.out;
      slice8.in = current_0.out;
      currSand_0.in = state0_0_0.read_data;
      upd7[done] = currSand_0.done;
    }
    group upd8<"promotable"=1> {
      newSand_0.write_en = 1'd1;
      sub0.left = currSand_0.out;
      sub0.right = const18.out;
      newSand_0.in = sub0.out;
      upd8[done] = newSand_0.done;
    }
    group upd9<"promotable"=1> {
      spills_0.write_en = 1'd1;
      add4.left = spills_0.out;
      add4.right = const19.out;
      spills_0.in = add4.out;
      upd9[done] = spills_0.done;
    }
  }
  control {
    seq {
      par {
        @pos(0) let0;
        @pos(1) let1;
        @pos(2) let2;
        @pos(3) let3;
      }
      @pos(4) let4;
      repeat 10 {
        seq {
          @pos(5) let5;
          repeat 10 {
            seq {
              @pos(6) let6;
              @pos(7) upd0;
              @pos(5) upd1;
            }
          }
          @pos(4) upd2;
        }
      }
      @pos(8) let7;
      repeat 10 {
        seq {
          @pos(9) let8;
          repeat 10 {
            seq {
              @pos(10) let9;
              @pos(11) upd3;
              @pos(9) upd4;
            }
          }
          @pos(8) upd5;
        }
      }
      while neq0.out with cond5 {
        seq {
          @pos(12) upd6;
          par {
            seq {
              @pos(13) let10;
              repeat 8 {
                seq {
                  @pos(14) let11;
                  repeat 8 {
                    seq {
                      @pos(15) upd7;
                      if ge0.out with cond0 {
                        par {
                          @pos(16) upd8;
                          upd9;
                        }
                      } else {
                        @pos(17) upd10;
                      }
                      @pos(18) upd11;
                      if ge1.out with cond1 {
                        upd12;
                      }
                      @pos(19) upd13;
                      if ge2.out with cond2 {
                        upd14;
                      }
                      @pos(20) upd15;
                      if ge3.out with cond3 {
                        upd16;
                      }
                      @pos(21) upd17;
                      if ge4.out with cond4 {
                        upd18;
                      }
                      @pos(22) upd19;
                      @pos(14) upd20;
                    }
                  }
                  @pos(13) upd21;
                }
              }
            }
            upd22;
          }
          par {
            @pos(23) upd23;
            @pos(24) upd24;
          }
        }
      }
      @pos(25) let12;
      repeat 10 {
        seq {
          @pos(26) let13;
          repeat 10 {
            seq {
              @pos(27) upd25;
              @pos(28) upd26;
              @pos(26) upd27;
            }
          }
          @pos(25) upd28;
        }
      }
    }
  }
}
metadata #{
  0: let spills: ubit<32> = 1;
  1: let iterations : ubit<32> = 0;
  2: let current: ubit<4> = 0;
  3: let next: ubit<4> = 1;
  4:     for(let i: ubit<32> = 0..10) {
  5:         for(let j: ubit<32> = 0..10) {
  6:             let val: ubit<32> = in_int[i][j];
  7:             state[0][i][j] := val;
  8:     for(let i: ubit<32> = 0..10) {
  9:         for(let j: ubit<32> = 0..10) {
  10:             let val: ubit<32> = in_int[i][j];
  11:             state[1][i][j] := val;
  12:         spills := 0;
  13:         for(let y: ubit<32> = 1..9) {
  14:             for(let x: ubit<32> = 1..9) {
  15:                 let currSand : ubit<32> = state[current][y][x];
  16:                     newSand := currSand - 4;
  17:                     newSand := currSand;
  18:                 if(state[current][y - 1][x] >= 4) {
  19:                 if(state[current][y + 1][x] >= 4) {
  20:                 if(state[current][y][x + 1] >= 4) {
  21:                 if(state[current][y][x - 1] >= 4) {
  22:                 state[next][y][x] := newSand;
  23:         current := (current + 1) & 1;
  24:         next := (next + 1) & 1;
  25:     for(let i: ubit<32> = 0..10) {
  26:         for(let j: ubit<32> = 0..10) {
  27:             out_int[i][j] := state[current][i][j];
  28:             out_int[i][j] := state[current][i][j];
}#
