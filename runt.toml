ver = "0.2.4"

[[tests]]
name = "List passes"
paths = [ "tests/list-passes/out" ]
cmd = "./target/debug/futil --list-passes"

[[tests]]
name = "Dahlia frontend for Futil"
paths = [ "tests/integration-dahlia-sources/*.fuse" ]
cmd = "dahlia {} -b futil"
expect_dir = "tests/integration-futil/"

[[tests]]
name = "Futil lowering"
paths = [ "tests/integration-futil/*.expect" ]
cmd = "./target/debug/futil {}"
expect_dir = "tests/integration-futil-lowered"

[[tests]]
name = "Verilog generation"
paths = [ "tests/integration-futil/*.expect" ]
cmd = "./target/debug/futil {} -b verilog"
expect_dir = "tests/integration-verilog"

[[tests]]
name = "Verilog Simulation"
paths = [ "tests/integration-verilog/*.expect" ]
cmd = "./bin/gen-vcd {} 2>/dev/null | vcdump"
expect_dir = "tests/integration-simulation"

# [[tests]]
# name = "Full Integration"
# paths = [ "tests/integration-dahlia-sources/*.fuse" ]
# cmd = "dahlia {} -b futil | ./target/debug/futil -b verilog | ./bin/gen.vcd - | vcdump"
# expect_dir = "tests/integration-full"

# [[tests]]
# name = "Primitive Component tests"
# paths = [ "tests/verilog-primitives/*.futil" ]
# cmd = """
# full={}
# f=${full%.*}
# make $f.res 1>/dev/null 2>/dev/null
# cat $f.res
# rm $f.res"""