---
source: fud2/tests/tests.rs
description: "emit plan: vitis-hls"
---
build-tool = fud2
rule get-rsrc
  command = $build-tool get-rsrc $out

vitis-hls-top = kernel
build hls.cfg: get-rsrc
rule vitis-hls
  command = v++ -c --mode hls --config hls.cfg --work_dir out --hls.syn.top=$vitis-hls-top > /dev/null
rule vitis-hls-impl
  command = vitis-run --impl --config hls.cfg --work_dir out --hls.syn.top=$vitis-hls-top > /dev/null
rule extract-hls-json
  command = synthrep summary -m hls --top $vitis-hls-top > $out
rule extract-hls-impl-json
  command = synthrep summary -m hls-impl --top $vitis-hls-top > $out
rule copy
  command = cp $in $out

build kernel.cpp: copy /input.ext
build hls-out: vitis-hls | kernel.cpp hls.cfg
build hls-impl-out: vitis-hls-impl hls-out
build /output.ext: extract-hls-json hls-out

default /output.ext
