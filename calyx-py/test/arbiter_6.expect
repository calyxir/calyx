import "primitives/core.futil";
import "primitives/binary_operators.futil";
component wrap2(i: 32, j: 32) -> () {
  cells {
    ref mem0 = std_mem_d1(32, 4, 32);
    ref mem1 = std_mem_d1(32, 4, 32);
    ref mem2 = std_mem_d1(32, 4, 32);
    ref mem3 = std_mem_d1(32, 4, 32);
    ref mem4 = std_mem_d1(32, 4, 32);
    ref mem5 = std_mem_d1(32, 4, 32);
    ref ans = std_mem_d1(32, 1, 32);
    j_mod_4 = std_reg(32);
    eq0 = std_eq(32);
    eq1 = std_eq(32);
    lt1 = std_lt(32);
    lt2 = std_lt(32);
    sub = std_sub(32);
  }
  wires {
    comb group i_eq_0 {
      eq0.left = i;
      eq0.right = 32'd0;
    }
    comb group i_eq_1 {
      eq1.left = i;
      eq1.right = 32'd1;
    }
    comb group j_lt_4 {
      lt1.left = j;
      lt1.right = 32'd4;
    }
    comb group j_lt_8 {
      lt2.left = j;
      lt2.right = 32'd8;
    }
    group j_unchanged {
      j_mod_4.write_en = 1'd1;
      j_mod_4.in = j;
      j_unchanged[done] = j_mod_4.done;
    }
    group j_minus_4 {
      sub.left = j;
      sub.right = 32'd4;
      j_mod_4.write_en = 1'd1;
      j_mod_4.in = sub.out;
      j_minus_4[done] = j_mod_4.done;
    }
    group j_minus_8 {
      sub.left = j;
      sub.right = 32'd8;
      j_mod_4.write_en = 1'd1;
      j_mod_4.in = sub.out;
      j_minus_8[done] = j_mod_4.done;
    }
    group load_from_mem0 {
      mem0.addr0 = j_mod_4.out;
      ans.write_en = 1'd1;
      ans.write_data = mem0.read_data;
      load_from_mem0[done] = ans.done;
    }
    group load_from_mem1 {
      mem1.addr0 = j_mod_4.out;
      ans.write_en = 1'd1;
      ans.write_data = mem1.read_data;
      load_from_mem1[done] = ans.done;
    }
    group load_from_mem2 {
      mem2.addr0 = j_mod_4.out;
      ans.write_en = 1'd1;
      ans.write_data = mem2.read_data;
      load_from_mem2[done] = ans.done;
    }
    group load_from_mem3 {
      mem3.addr0 = j_mod_4.out;
      ans.write_en = 1'd1;
      ans.write_data = mem3.read_data;
      load_from_mem3[done] = ans.done;
    }
    group load_from_mem4 {
      mem4.addr0 = j_mod_4.out;
      ans.write_en = 1'd1;
      ans.write_data = mem4.read_data;
      load_from_mem4[done] = ans.done;
    }
    group load_from_mem5 {
      mem5.addr0 = j_mod_4.out;
      ans.write_en = 1'd1;
      ans.write_data = mem5.read_data;
      load_from_mem5[done] = ans.done;
    }
  }
  control {
    seq {
      if lt1.out with j_lt_4 {
        j_unchanged;
      } else {
        if lt2.out with j_lt_8 {
          j_minus_4;
        } else {
          j_minus_8;
        }
      }
      par {
        if eq0.out with i_eq_0 {
          if lt1.out with j_lt_4 {
            load_from_mem0;
          } else {
            if lt2.out with j_lt_8 {
              load_from_mem1;
            } else {
              load_from_mem2;
            }
          }
        }
        if eq1.out with i_eq_1 {
          if lt1.out with j_lt_4 {
            load_from_mem3;
          } else {
            if lt2.out with j_lt_8 {
              load_from_mem4;
            } else {
              load_from_mem5;
            }
          }
        }
      }
    }
  }
}
component wrap3(i: 32, j: 32) -> () {
  cells {
    ref mem0 = std_mem_d1(32, 4, 32);
    ref mem1 = std_mem_d1(32, 4, 32);
    ref mem2 = std_mem_d1(32, 4, 32);
    ref mem3 = std_mem_d1(32, 4, 32);
    ref mem4 = std_mem_d1(32, 4, 32);
    ref mem5 = std_mem_d1(32, 4, 32);
    ref ans = std_mem_d1(32, 1, 32);
    j_mod_4 = std_reg(32);
    eq0 = std_eq(32);
    eq1 = std_eq(32);
    eq2 = std_eq(32);
    lt = std_lt(32);
    sub = std_sub(32);
  }
  wires {
    comb group i_eq_0 {
      eq0.left = i;
      eq0.right = 32'd0;
    }
    comb group i_eq_1 {
      eq1.left = i;
      eq1.right = 32'd1;
    }
    comb group i_eq_2 {
      eq2.left = i;
      eq2.right = 32'd2;
    }
    comb group j_lt_4 {
      lt.left = j;
      lt.right = 32'd4;
    }
    group j_unchanged {
      j_mod_4.write_en = 1'd1;
      j_mod_4.in = j;
      j_unchanged[done] = j_mod_4.done;
    }
    group j_minus_4 {
      sub.left = j;
      sub.right = 32'd4;
      j_mod_4.write_en = 1'd1;
      j_mod_4.in = sub.out;
      j_minus_4[done] = j_mod_4.done;
    }
    group load_from_mem0 {
      mem0.addr0 = j_mod_4.out;
      ans.write_en = 1'd1;
      ans.write_data = mem0.read_data;
      load_from_mem0[done] = ans.done;
    }
    group load_from_mem1 {
      mem1.addr0 = j_mod_4.out;
      ans.write_en = 1'd1;
      ans.write_data = mem1.read_data;
      load_from_mem1[done] = ans.done;
    }
    group load_from_mem2 {
      mem2.addr0 = j_mod_4.out;
      ans.write_en = 1'd1;
      ans.write_data = mem2.read_data;
      load_from_mem2[done] = ans.done;
    }
    group load_from_mem3 {
      mem3.addr0 = j_mod_4.out;
      ans.write_en = 1'd1;
      ans.write_data = mem3.read_data;
      load_from_mem3[done] = ans.done;
    }
    group load_from_mem4 {
      mem4.addr0 = j_mod_4.out;
      ans.write_en = 1'd1;
      ans.write_data = mem4.read_data;
      load_from_mem4[done] = ans.done;
    }
    group load_from_mem5 {
      mem5.addr0 = j_mod_4.out;
      ans.write_en = 1'd1;
      ans.write_data = mem5.read_data;
      load_from_mem5[done] = ans.done;
    }
  }
  control {
    seq {
      if lt.out with j_lt_4 {
        j_unchanged;
      } else {
        j_minus_4;
      }
      par {
        if eq0.out with i_eq_0 {
          if lt.out with j_lt_4 {
            load_from_mem0;
          } else {
            load_from_mem1;
          }
        }
        if eq1.out with i_eq_1 {
          if lt.out with j_lt_4 {
            load_from_mem2;
          } else {
            load_from_mem3;
          }
        }
        if eq2.out with i_eq_2 {
          if lt.out with j_lt_4 {
            load_from_mem4;
          } else {
            load_from_mem5;
          }
        }
      }
    }
  }
}
component main() -> () {
  cells {
    @external A = std_mem_d1(32, 4, 32);
    @external B = std_mem_d1(32, 4, 32);
    @external C = std_mem_d1(32, 4, 32);
    @external D = std_mem_d1(32, 4, 32);
    @external E = std_mem_d1(32, 4, 32);
    @external F = std_mem_d1(32, 4, 32);
    @external out2 = std_mem_d1(32, 1, 32);
    @external out3 = std_mem_d1(32, 1, 32);
    together2 = wrap2();
    together3 = wrap3();
  }
  wires {

  }
  control {
    seq {
      invoke together2[mem0=A, mem1=B, mem2=C, mem3=D, mem4=E, mem5=F, ans=out2](i=32'd1, j=32'd11)();
      invoke together3[mem0=A, mem1=B, mem2=C, mem3=D, mem4=E, mem5=F, ans=out3](i=32'd2, j=32'd7)();
    }
  }
}
