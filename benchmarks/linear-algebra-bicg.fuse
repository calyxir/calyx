decl A: ubit<32>[8][8];
decl s: ubit<32>[8];
decl q: ubit<32>[8];
decl p: ubit<32>[8];
decl r: ubit<32>[8];

for (let i: ubit<4> = 0..8) {
  s[i] := 0;
}

---

for (let i: ubit<4> = 0..8) {
  q[i] := 0;
  ---
  for (let j: ubit<4> = 0..8) {
    let s0: ubit<32> = s[j];
    let q0: ubit<32> = q[i];
    let A_i_j: ubit<32> = A[i][j];
    ---
    s[j] := s0 + r[i] * A_i_j;
    q[i] := q0 + A_i_j * p[j];
  }
}
